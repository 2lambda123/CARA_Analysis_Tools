function Pc3D_Hall_Example2
%
% Example validation case for the Pc3D_Hall.m function, using data from an
% actual NASA CARA conjunction.
%
% Case 2: Example with 3D-Pc much larger than 2D-Pc (which happens only
%         occasionally for high relative velocity encounters).
%
% Executing the test case code below should yield the following output:
%
%     Pc2D = 2.2660751e-20
%     Pc3D = 1.9271947e-05
%
% Estimates of this conjunction's Pc value from Monte Carlo simulations:
%
%   From-TCA Two Body Motion Monte Carlo:
%    TBMC-Pc = 1.938E-05 = 19384 hits / 1e9 trials
%            = 1.911E-05 to 1.966E-05 (95% confidence)
%
%   From-Epoch High-Fidelity Motion Brute Force Monte Carlo:
%    BFMC-Pc = 1.89E-05 = 189 hits / 1e7 trials
%            = 1.63E-05  to 2.18E-05  (95% confidence)

% Set up the default parameters required by the Pc3D_Hall.m function.
% (This only needs to be done once. When using Pc3D_Hall multiple times,
% this prevents needless recalcaution of Lebedev quadrature coefficients.)
params = []; Lebedev_warning = false;
params = default_params_Pc3D_Hall(params,Lebedev_warning);

%  Begin test case code:

 r1   = [-8.379648052122305e+05 -8.171881765929216e+05 +7.094136052638983e+06];
 v1   = [-2.670646534000000e+03 +6.931563469000001e+03 +4.827786630000000e+02];
 cov1 = [+3.612023799984759e+03 -9.400236231297700e+03 -6.298653147777720e+02 -1.202684255279736e+00 -1.195413704199584e+00 +1.029005367422424e+01; ...
         -9.400236231297700e+03 +2.450614906178152e+04 +1.607596675826002e+03 +3.121860335933878e+00 +3.148734627832713e+00 -2.679241909910183e+01; ...
         -6.298653147777720e+02 +1.607596675826002e+03 +1.406314287206610e+02 +2.212445034390649e-01 +1.748905714166198e-01 -1.790030136624526e+00; ...
         -1.202684255279736e+00 +3.121860335933878e+00 +2.212445034390649e-01 +4.100943787418265e-04 +3.881475523378179e-04 -3.426808331436135e-03; ...
         -1.195413704199584e+00 +3.148734627832713e+00 +1.748905714166198e-01 +3.881475523378179e-04 +4.338196284756884e-04 -3.412770719926683e-03; ...
         +1.029005367422424e+01 -2.679241909910183e+01 -1.790030136624526e+00 -3.426808331436135e-03 -3.412770719926683e-03 +2.932410138619841e-02];
 r2   = [-8.422428532071497e+05 -8.112667514450154e+05 +7.094252069897899e+06];
 v2   = [-2.721887601000000e+03 +6.894980919000000e+03 +4.604465340000000e+02];
 cov2 = [+2.303936308436524e+06 -5.840532288944656e+06 -3.787361484509318e+05 -7.608259948141956e+02 -7.387338590483123e+02 +6.430609571359349e+03; ...
         -5.840532288944656e+06 +1.481047129720380e+07 +9.588422637973342e+05 +1.930192636857187e+03 +1.875463060297046e+03 -1.630488996414758e+04; ...
         -3.787361484509318e+05 +9.588422637973342e+05 +6.291927755710058e+04 +1.249282447353183e+02 +1.204713790075250e+02 -1.056693230659719e+03; ...
         -7.608259948141956e+02 +1.930192636857187e+03 +1.249282447353183e+02 +2.529380020503447e-01 +2.450869573945440e-01 -2.125411869974591e+00; ...
         -7.387338590483123e+02 +1.875463060297046e+03 +1.204713790075250e+02 +2.450869573945440e-01 +2.388441170812859e-01 -2.063699637609335e+00; ...
         +6.430609571359349e+03 -1.630488996414758e+04 -1.056693230659719e+03 -2.125411869974591e+00 -2.063699637609335e+00 +1.795194378858601e+01];
 HBR     = 20;
 Pc2D    = PcElrod(r1,v1,cov1,r2,v2,cov2,HBR);
 Pc3D    = Pc3D_Hall(r1,v1,cov1,r2,v2,cov2,HBR,params);
 disp(['Pc2D = ' num2str(Pc2D,'%0.7e')]); 
 disp(['Pc3D = ' num2str(Pc3D,'%0.7e')]);

% End test case code.

return;
end